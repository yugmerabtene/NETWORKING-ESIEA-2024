### Énoncé : Configuration d'un Serveur Web Apache et d'un Serveur DNS Local sous Linux

Vous avez deux serveurs sous Linux dans votre réseau local. Vous souhaitez configurer l'un de ces serveurs comme **serveur web** avec Apache pour héberger un site, et transformer l'autre en **serveur DNS** pour gérer le nom de domaine local `www.inf3050.esiea`, qui doit pointer vers le serveur web. Le domaine `www.inf3050.esiea` sera uniquement accessible dans votre réseau local.

### Objectif :
- Installer Apache sur le premier serveur pour héberger un site web.
- Installer et configurer BIND sur le second serveur pour gérer la résolution DNS locale du domaine `www.inf3050.esiea`, qui pointera vers le serveur web.

### Prérequis :
- Deux serveurs sous Linux : 
  - **Serveur Web** (avec l'adresse IP que vous choisirez).
  - **Serveur DNS** (avec l'adresse IP que vous choisirez).
- Accès administrateur sur les deux serveurs.

---

### Étapes de Configuration

#### Étape 1 : Configuration du Serveur Web avec Apache

1. **Mettre à jour le système** :
   ```bash
   sudo apt update
   ```

2. **Installer Apache** :
   Installez Apache pour qu'il puisse servir le contenu web.
   ```bash
   sudo apt install apache2 -y
   ```

3. **Vérifier qu’Apache fonctionne** :
   Ouvrez un navigateur et entrez l’adresse IP du serveur web. Vous devriez voir la page par défaut d’Apache si l’installation est réussie.

4. **Configurer le nom de domaine dans Apache** (facultatif) :
   - Créez un fichier de configuration pour le domaine `www.inf3050.esiea` :
     ```bash
     sudo nano /etc/apache2/sites-available/inf3050.esiea.conf
     ```

   - Ajoutez cette configuration :
     ```apache
     <VirtualHost *:80>
         ServerName www.inf3050.esiea
         DocumentRoot /var/www/html
         <Directory /var/www/html>
             AllowOverride All
             Require all granted
         </Directory>
     </VirtualHost>
     ```

   - Activez le site et redémarrez Apache :
     ```bash
     sudo a2ensite inf3050.esiea.conf
     sudo systemctl restart apache2
     ```

   À ce stade, Apache est configuré pour servir `www.inf3050.esiea`. Le serveur web est maintenant prêt.

---

#### Étape 2 : Configuration du Serveur DNS avec BIND

1. **Installer BIND** :
   Installez BIND pour configurer un serveur DNS.
   ```bash
   sudo apt install bind9 -y
   ```

2. **Configurer la zone DNS pour le domaine `inf3050.esiea`** :
   - Ouvrez le fichier de configuration de BIND pour ajouter une nouvelle zone pour le domaine `inf3050.esiea` :
     ```bash
     sudo nano /etc/bind/named.conf.local
     ```
   - Ajoutez la configuration suivante :
     ```bash
     zone "inf3050.esiea" {
         type master;
         file "/etc/bind/db.inf3050.esiea";
     };
     ```

3. **Créer le fichier de zone pour `inf3050.esiea`** :
   - Créez le fichier de zone qui contiendra les enregistrements DNS pour `inf3050.esiea`.
     ```bash
     sudo nano /etc/bind/db.inf3050.esiea
     ```

   - Ajoutez le contenu suivant, en remplaçant `[IP_DU_SERVEUR_WEB]` par l’adresse IP du serveur web :
     ```bind
     $TTL 86400
     @   IN  SOA     ns1.inf3050.esiea. admin.inf3050.esiea. (
                      2023101001 ; Numéro de série
                      3600       ; Actualisation (1 heure)
                      1800       ; Tentative de mise à jour échouée (30 minutes)
                      1209600    ; Expiration (2 semaines)
                      86400      ; TTL par défaut (1 jour)
                      )

     ; Enregistrements DNS
     @   IN  NS      ns1.inf3050.esiea.
     ns1 IN  A       [IP_DU_SERVEUR_DNS]
     www IN  A       [IP_DU_SERVEUR_WEB]
     ```

     - **@** représente le domaine `inf3050.esiea`.
     - **NS** spécifie le serveur DNS autoritaire.
     - **A** associe `www.inf3050.esiea` à l’adresse IP du serveur web `[IP_DU_SERVEUR_WEB]`.

4. **Vérifier la Configuration de BIND** :
   - Vérifiez la syntaxe des fichiers de configuration de BIND pour éviter les erreurs :
     ```bash
     sudo named-checkconf
     sudo named-checkzone inf3050.esiea /etc/bind/db.inf3050.esiea
     ```

5. **Redémarrer BIND** :
   - Redémarrez le service BIND pour appliquer les changements :
     ```bash
     sudo systemctl restart bind9
     ```

6. **Tester la Résolution de Noms** :
   - Utilisez la commande suivante sur le serveur DNS pour vérifier que `www.inf3050.esiea` pointe bien vers l’adresse IP du serveur web :
     ```bash
     dig @localhost www.inf3050.esiea
     ```

   - Vous devriez voir l’adresse IP du serveur web dans la réponse.

---

#### Étape 3 : Configurer les Clients pour Utiliser le Serveur DNS

Sur chaque client du réseau, configurez les paramètres DNS pour qu'ils utilisent l’adresse IP de votre **Serveur DNS**. Cela permettra aux clients de résoudre `www.inf3050.esiea` vers l'IP du serveur web.

---

### Résumé des Étapes
- **Serveur Web** : Installation et configuration d’Apache pour servir un site accessible par `www.inf3050.esiea`.
- **Serveur DNS** : Installation de BIND et configuration de la zone `inf3050.esiea` pour faire pointer `www.inf3050.esiea` vers l’IP du serveur web.
- **Clients** : Configuration pour utiliser l'adresse IP du Serveur DNS, ce qui permet de résoudre le domaine local.

Cette configuration rend `www.inf3050.esiea` accessible uniquement dans votre réseau local, permettant un accès contrôlé et privé au site hébergé sur votre serveur Apache.
